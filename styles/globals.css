/* ===== SYSTÈME DE DESIGN CSS MODERNE ===== */

/* ===== FONDATIONS CSS LAYERS ===== */
@layer base, theme, components, utilities;

/* ===== VARIABLES CSS AVANCÉES ===== */
@layer base {
  :root {
    /* --- Système de couleurs OKLCH avancé --- */
    /* Couleurs de base */
    --color-white: oklch(1 0 0);
    --color-black: oklch(0 0 0);
    
    /* Gris évolutif */
    --color-gray-50: oklch(0.985 0 0);
    --color-gray-100: oklch(0.967 0.001 260);
    --color-gray-200: oklch(0.92 0.005 260);
    --color-gray-300: oklch(0.87 0.01 260);
    --color-gray-400: oklch(0.71 0.015 260);
    --color-gray-500: oklch(0.55 0.02 260);
    --color-gray-600: oklch(0.44 0.02 260);
    --color-gray-700: oklch(0.37 0.015 260);
    --color-gray-800: oklch(0.27 0.01 260);
    --color-gray-900: oklch(0.21 0.008 260);
    --color-gray-950: oklch(0.14 0.006 260);
    
    /* Couleurs sémantiques - Thème clair */
    --color-background: var(--color-gray-50);
    --color-foreground: var(--color-gray-950);
    --color-surface: var(--color-white);
    --color-surface-elevated: color-mix(in oklch, var(--color-white), transparent 95%);
    
    /* Bordures et séparateurs */
    --color-border: var(--color-gray-200);
    --color-border-strong: var(--color-gray-300);
    --color-separator: var(--color-gray-100);
    
    /* États et interactions */
    --color-ring: var(--color-primary-500);
    --color-focus-ring: color-mix(in oklch, var(--color-primary-500), transparent 40%);
    --color-hover: color-mix(in oklch, var(--color-gray-950), transparent 96%);
    --color-active: color-mix(in oklch, var(--color-gray-950), transparent 92%);
    
    /* Textes */
    --color-text-primary: var(--color-gray-950);
    --color-text-secondary: var(--color-gray-600);
    --color-text-tertiary: var(--color-gray-500);
    --color-text-muted: var(--color-gray-400);
    --color-text-on-primary: var(--color-white);
    --color-text-on-accent: var(--color-gray-950);
    
    /* Couleurs primaires - Moderne */
    --color-primary-50: oklch(95.814% 0.00854 197.719);
    --color-primary-100: oklch(0.92 0.12 260);
    --color-primary-200: oklch(0.83 0.18 260);
    --color-primary-300: oklch(0.74 0.22 260);
    --color-primary-400: oklch(0.65 0.25 260);
    --color-primary-500: oklch(0.55 0.27 260);
    --color-primary-600: oklch(0.47 0.25 260);
    --color-primary-700: oklch(0.41 0.22 260);
    --color-primary-800: oklch(0.35 0.18 260);
    --color-primary-900: oklch(0.27 0.15 260);
    --color-primary-950: oklch(0.2 0.12 260);
    
    --color-primary: var(--color-primary-500);
    --color-primary-foreground: var(--color-white);
    
    /* Couleurs d'accent */
    --color-accent-50: oklch(97.572% 0.01181 16.844);
    --color-accent-100: oklch(0.9 0.1 140);
    --color-accent-500: oklch(0.7 0.2 140);
    --color-accent-700: oklch(0.55 0.18 140);
    
    --color-accent: var(--color-accent-500);
    --color-accent-foreground: var(--color-gray-950);
    
    /* États fonctionnels */
    --color-success-50: oklch(100% 0.00011 271.152);
    --color-success-500: oklch(0.7 0.18 145);
    --color-success-700: oklch(0.55 0.15 145);
    
    --color-success: var(--color-success-500);
    --color-success-foreground: var(--color-white);
    
    --color-warning-50: oklch(0.97 0.06 75);
    --color-warning-500: oklch(0.75 0.2 75);
    --color-warning-700: oklch(0.6 0.16 75);
    
    --color-warning: var(--color-warning-500);
    --color-warning-foreground: var(--color-gray-950);
    
    --color-info-50: oklch(99.557% 0.0021 14.222);
    --color-info-500: oklch(0.7 0.15 220);
    --color-info-700: oklch(0.55 0.12 220);
    
    --color-info: var(--color-info-500);
    --color-info-foreground: var(--color-white);
    
    --color-destructive-50: oklch(100% 0.00011 271.152);
    --color-destructive-500: oklch(0.65 0.25 25);
    --color-destructive-700: oklch(0.55 0.2 25);
    
    --color-destructive: var(--color-destructive-500);
    --color-destructive-foreground: var(--color-white);
    
    /* --- Dégradés avancés --- */
    --gradient-primary: linear-gradient(
      135deg, 
      var(--color-primary-400) 0%, 
      var(--color-primary-600) 100%
    );
    
    --gradient-primary-subtle: linear-gradient(
      135deg, 
      color-mix(in oklch, var(--color-primary-50), transparent 30%) 0%, 
      color-mix(in oklch, var(--color-primary-100), transparent 50%) 100%
    );
    
    --gradient-accent: linear-gradient(
      135deg, 
      var(--color-accent-100) 0%, 
      var(--color-accent-500) 100%
    );
    
    --gradient-surface: linear-gradient(
      135deg, 
      var(--color-surface) 0%, 
      color-mix(in oklch, var(--color-surface), transparent 5%) 100%
    );
    
    --gradient-glass: linear-gradient(
      135deg, 
      rgba(255, 250, 250, 0.85) 0%, 
      rgba(243, 243, 243, 0.7) 100%
    );
    
    --gradient-border: linear-gradient(
      90deg, 
      transparent 0%, 
      var(--color-border) 50%, 
      transparent 100%
    );
    
    /* --- Système d'ombres avancé --- */
    --shadow-color: 220 3% 15%;
    --shadow-strength: 1%;
    
    --shadow-sm: 
      0 1px 2px -1px hsl(var(--shadow-color) / calc(var(--shadow-strength) + 9%));
    
    --shadow-md: 
      0 3px 5px -2px hsl(var(--shadow-color) / calc(var(--shadow-strength) + 3%)),
      0 7px 14px -5px hsl(var(--shadow-color) / calc(var(--shadow-strength) + 5%));
    
    --shadow-lg: 
      0 10px 15px -3px hsl(var(--shadow-color) / calc(var(--shadow-strength) + 2%)),
      0 25px 50px -12px hsl(var(--shadow-color) / calc(var(--shadow-strength) + 8%));
    
    --shadow-xl:
      0 20px 25px -5px hsl(var(--shadow-color) / calc(var(--shadow-strength) + 2%)),
      0 50px 100px -20px hsl(var(--shadow-color) / calc(var(--shadow-strength) + 12%));
    
    --shadow-soft:
      0 20px 60px hsl(var(--shadow-color) / calc(var(--shadow-strength) + 6%));
    
    --shadow-strong:
      0 25px 80px hsl(var(--shadow-color) / calc(var(--shadow-strength) + 12%));
    
    --shadow-inner:
      inset 0 2px 4px 0 hsl(var(--shadow-color) / calc(var(--shadow-strength) + 6%));
    
    --shadow-glow:
      0 0 0 1px color-mix(in oklch, var(--color-primary-500), transparent 70%),
      0 0 40px color-mix(in oklch, var(--color-primary-400), transparent 85%);
    
    /* --- Typographie moderne --- */
    --font-family-sans: 
      'Geist', 
      'Inter Variable', 
      'Space Grotesk Variable', 
      system-ui, 
      -apple-system, 
      'BlinkMacSystemFont', 
      'Segoe UI', 
      'Roboto', 
      'Helvetica Neue', 
      'Arial', 
      sans-serif;
    
    --font-family-mono: 
      'Geist Mono', 
      'JetBrains Mono Variable', 
      'Cascadia Code', 
      'Fira Code', 
      'Monaspace', 
      ui-monospace, 
      'SFMono-Regular', 
      'Menlo', 
      'Monaco', 
      'Consolas', 
      monospace;
    
    --font-family-serif: 
      'Source Serif 4', 
      'Newsreader', 
      'Charter', 
      'Times New Roman', 
      serif;
    
    /* Échelle typographique modulaire */
    --text-xs: 0.75rem;
    --text-xs--line-height: 1rem;
    
    --text-sm: 0.875rem;
    --text-sm--line-height: 1.25rem;
    
    --text-base: 1rem;
    --text-base--line-height: 1.5rem;
    
    --text-lg: 1.125rem;
    --text-lg--line-height: 1.75rem;
    
    --text-xl: 1.25rem;
    --text-xl--line-height: 1.75rem;
    
    --text-2xl: 1.5rem;
    --text-2xl--line-height: 2rem;
    
    --text-3xl: 1.875rem;
    --text-3xl--line-height: 2.25rem;
    
    --text-4xl: 2.25rem;
    --text-4xl--line-height: 2.5rem;
    
    --text-5xl: 3rem;
    --text-5xl--line-height: 1;
    
    --text-6xl: 3.75rem;
    --text-6xl--line-height: 1;
    
    --text-7xl: 4.5rem;
    --text-7xl--line-height: 1;
    
    --text-8xl: 6rem;
    --text-8xl--line-height: 1;
    
    --text-9xl: 8rem;
    --text-9xl--line-height: 1;
    
    /* Poids de police */
    --font-weight-thin: 100;
    --font-weight-extralight: 200;
    --font-weight-light: 300;
    --font-weight-normal: 400;
    --font-weight-medium: 500;
    --font-weight-semibold: 600;
    --font-weight-bold: 700;
    --font-weight-extrabold: 800;
    --font-weight-black: 900;
    
    /* Tracking (lettre-spacing) */
    --tracking-tighter: -0.05em;
    --tracking-tight: -0.025em;
    --tracking-normal: 0em;
    --tracking-wide: 0.025em;
    --tracking-wider: 0.05em;
    --tracking-widest: 0.1em;
    
    /* --- Système d'espacement --- */
    --space-unit: 0.25rem;
    
    --space-0: 0;
    --space-px: 1px;
    --space-half: calc(var(--space-unit) * 0.5);
    --space-1: var(--space-unit);
    --space-1-5: calc(var(--space-unit) * 1.5);
    --space-2: calc(var(--space-unit) * 2);
    --space-2-5: calc(var(--space-unit) * 2.5);
    --space-3: calc(var(--space-unit) * 3);
    --space-3-5: calc(var(--space-unit) * 3.5);
    --space-4: calc(var(--space-unit) * 4);
    --space-5: calc(var(--space-unit) * 5);
    --space-6: calc(var(--space-unit) * 6);
    --space-7: calc(var(--space-unit) * 7);
    --space-8: calc(var(--space-unit) * 8);
    --space-9: calc(var(--space-unit) * 9);
    --space-10: calc(var(--space-unit) * 10);
    --space-11: calc(var(--space-unit) * 11);
    --space-12: calc(var(--space-unit) * 12);
    --space-14: calc(var(--space-unit) * 14);
    --space-16: calc(var(--space-unit) * 16);
    --space-20: calc(var(--space-unit) * 20);
    --space-24: calc(var(--space-unit) * 24);
    --space-28: calc(var(--space-unit) * 28);
    --space-32: calc(var(--space-unit) * 32);
    --space-36: calc(var(--space-unit) * 36);
    --space-40: calc(var(--space-unit) * 40);
    --space-44: calc(var(--space-unit) * 44);
    --space-48: calc(var(--space-unit) * 48);
    --space-52: calc(var(--space-unit) * 52);
    --space-56: calc(var(--space-unit) * 56);
    --space-60: calc(var(--space-unit) * 60);
    --space-64: calc(var(--space-unit) * 64);
    --space-72: calc(var(--space-unit) * 72);
    --space-80: calc(var(--space-unit) * 80);
    --space-96: calc(var(--space-unit) * 96);
    
    /* Gouttières responsive */
    --gutter-base: clamp(1rem, 4vw, 1.5rem);
    --gutter-lg: clamp(1.5rem, 5vw, 3rem);
    --gutter-xl: clamp(2rem, 6vw, 4rem);
    
    /* --- Bordures et rayons --- */
    --border-width: 1px;
    --border-width-thick: 2px;
    --border-width-heavy: 3px;
    
    --radius-none: 0;
    --radius-xs: 0.125rem;
    --radius-sm: 0.25rem;
    --radius-md: 0.375rem;
    --radius-lg: 0.5rem;
    --radius-xl: 0.75rem;
    --radius-2xl: 1rem;
    --radius-3xl: 1.5rem;
    --radius-4xl: 2rem;
    --radius-full: 9999px;
    
    /* --- Transitions et animations --- */
    --duration-instant: 50ms;
    --duration-fast: 150ms;
    --duration-base: 250ms;
    --duration-slow: 400ms;
    --duration-slower: 600ms;
    
    --ease-linear: linear;
    --ease-in: cubic-bezier(0.4, 0, 1, 1);
    --ease-out: cubic-bezier(0, 0, 0.2, 1);
    --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);
    --ease-soft: cubic-bezier(0.25, 0.1, 0.25, 1);
    --ease-smooth: cubic-bezier(0.4, 0, 0, 1);
    --ease-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
    
    /* Animations personnalisées */
    --animation-fade-in: fadeIn var(--duration-base) var(--ease-out);
    --animation-slide-up: slideUp var(--duration-base) var(--ease-out);
    --animation-scale-in: scaleIn var(--duration-base) var(--ease-out);
    --animation-spin: spin 1s linear infinite;
    
    /* --- Z-index systématique --- */
    --z-negative: -1;
    --z-base: 0;
    --z-elevated: 10;
    --z-dropdown: 1000;
    --z-sticky: 1020;
    --z-fixed: 1030;
    --z-modal-backdrop: 1040;
    --z-modal: 1050;
    --z-popover: 1060;
    --z-tooltip: 1070;
    --z-toast: 1080;
    --z-max: 9999;
    
    /* --- Effets visuels --- */
    --blur-backdrop: blur(8px);
    --blur-modal: blur(12px);
    --blur-tooltip: blur(4px);
    
    --backdrop-brightness: 100%;
    --backdrop-saturate: 100%;
    --backdrop-contrast: 100%;
    
    /* --- Responsive breakpoints --- */
    --breakpoint-xs: 20rem;   /* 320px */
    --breakpoint-sm: 30rem;   /* 480px */
    --breakpoint-md: 48rem;   /* 768px */
    --breakpoint-lg: 64rem;   /* 1024px */
    --breakpoint-xl: 80rem;   /* 1280px */
    --breakpoint-2xl: 96rem;  /* 1536px */
    
    /* --- Variables fonctionnelles --- */
    --header-height: 4rem;
    --sidebar-width: 16rem;
    --sidebar-width-collapsed: 4rem;
    --container-max-width: 80rem;
  }

  /* ===== THÈME SOMBRE AVANCÉ ===== */
  .dark, [data-theme="dark"] {
    /* Sémantique sombre */
    --color-background: var(--color-gray-950);
    --color-foreground: var(--color-gray-50);
    --color-surface: var(--color-gray-900);
    --color-surface-elevated: color-mix(in oklch, var(--color-gray-900), transparent 5%);
    
    /* Bordures et séparateurs */
    --color-border: var(--color-gray-800);
    --color-border-strong: var(--color-gray-700);
    --color-separator: var(--color-gray-800);
    
    /* États et interactions */
    --color-ring: var(--color-primary-400);
    --color-focus-ring: color-mix(in oklch, var(--color-primary-400), transparent 40%);
    --color-hover: color-mix(in oklch, var(--color-gray-50), transparent 96%);
    --color-active: color-mix(in oklch, var(--color-gray-50), transparent 92%);
    
    /* Textes */
    --color-text-primary: var(--color-gray-50);
    --color-text-secondary: var(--color-gray-400);
    --color-text-tertiary: var(--color-gray-500);
    --color-text-muted: var(--color-gray-600);
    --color-text-on-primary: var(--color-gray-950);
    --color-text-on-accent: var(--color-gray-50);
    
    /* Dégradés sombres */
    --gradient-primary: linear-gradient(
      135deg, 
      var(--color-primary-600) 0%, 
      var(--color-primary-800) 100%
    );
    
    --gradient-primary-subtle: linear-gradient(
      135deg, 
      color-mix(in oklch, var(--color-primary-900), transparent 30%) 0%, 
      color-mix(in oklch, var(--color-primary-950), transparent 50%) 100%
    );
    
    --gradient-surface: linear-gradient(
      135deg, 
      var(--color-surface) 0%, 
      color-mix(in oklch, var(--color-surface), transparent 10%) 100%
    );
    
    --gradient-glass: linear-gradient(
      135deg, 
      rgba(0, 0, 0, 0.2) 0%, 
      rgba(0, 0, 0, 0.4) 100%
    );
    
    /* Ombres sombres */
    --shadow-color: 0 0% 0%;
    --shadow-strength: 20%;
    
    --shadow-glow:
      0 0 0 1px color-mix(in oklch, var(--color-primary-400), transparent 70%),
      0 0 40px color-mix(in oklch, var(--color-primary-600), transparent 85%);
    
    /* Effets visuels sombres */
    --backdrop-brightness: 90%;
    --backdrop-saturate: 120%;
    --backdrop-contrast: 110%;
  }
}

/* ===== RESET ET BASE AVANCÉS ===== */
@layer base {
  *,
  *::before,
  *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
  }

  html {
    scroll-behavior: smooth;
    font-size: 16px;
    overflow-x: hidden;
    scroll-padding-top: var(--header-height);
    
    /* Optimisation des polices */
    font-kerning: normal;
    font-variant-numeric: lining-nums tabular-nums;
    font-feature-settings: "kern", "liga", "clig", "calt";
  }

  @media (prefers-reduced-motion: reduce) {
    html {
      scroll-behavior: auto;
    }
  }

  /* Fluid typography responsive */
  @media (max-width: 48rem) {
    html {
      font-size: 15px;
    }
  }

  @media (max-width: 30rem) {
    html {
      font-size: 14px;
    }
  }

  body {
    min-height: 100vh;
    min-height: 100dvh;
    font-family: var(--font-family-sans);
    font-size: var(--text-base);
    line-height: var(--text-base--line-height);
    color: var(--color-foreground);
    background-color: var(--color-background);
    background-image: 
      radial-gradient(
        circle at 50% 0%,
        color-mix(in oklch, var(--color-primary-50), transparent 95%) 0%,
        transparent 50%
      ),
      radial-gradient(
        circle at 10% 80%,
        color-mix(in oklch, var(--color-accent-50), transparent 98%) 0%,
        transparent 50%
      );
    overflow-x: hidden;
    position: relative;
    padding-top: var(--header-height);
  }

  /* Optimisation de contraste pour mobile */
  @media (max-width: 48rem) {
    body {
      -webkit-tap-highlight-color: transparent;
    }
  }

  /* ===== ÉLÉMENTS GLOBAUX AVANCÉS ===== */
  img,
  picture,
  video,
  canvas,
  svg {
    display: block;
    max-width: 100%;
    height: auto;
    object-fit: contain;
  }

  /* Images responsives */
  img[width][height] {
    aspect-ratio: attr(width) / attr(height);
  }

  /* Conteneurs media */
  .media-container {
    position: relative;
    overflow: hidden;
    border-radius: var(--radius-lg);
  }

  .media-container > * {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* Formulaires et contrôles */
  input,
  button,
  textarea,
  select {
    font: inherit;
    font-size: var(--text-base);
    color: inherit;
    background-color: transparent;
    border: none;
    outline: none;
  }

  /* Focus visible amélioré */
  :where(input, button, textarea, select, a):focus-visible {
    outline: 2px solid var(--color-focus-ring);
    outline-offset: 2px;
    border-radius: var(--radius-sm);
  }

  /* Focus pour éléments non interactifs */
  [tabindex]:focus-visible {
    outline: 2px solid var(--color-focus-ring);
    outline-offset: 2px;
  }

  /* Désactiver le focus pour les interactions souris */
  :where(input, button, textarea, select):focus:not(:focus-visible) {
    outline: none;
  }

  button {
    cursor: pointer;
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
    -webkit-user-select: none;
    user-select: none;
  }

  button:disabled {
    cursor: not-allowed;
    opacity: 0.5;
  }

  /* Liens */
  a {
    color: var(--color-primary-600);
    text-decoration: none;
    transition: color var(--duration-fast) var(--ease-out);
    position: relative;
  }

  a:hover {
    color: var(--color-primary-700);
  }

  a:active {
    color: var(--color-primary-800);
  }

  /* Liens avec underline animé */
  .link-underline {
    position: relative;
  }

  .link-underline::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 0;
    height: 1px;
    background-color: currentColor;
    transition: width var(--duration-base) var(--ease-out);
  }

  .link-underline:hover::after {
    width: 100%;
  }

  /* ===== TYPOGRAPHIE AVANCÉE ===== */
  h1, h2, h3, h4, h5, h6 {
    font-weight: var(--font-weight-bold);
    line-height: 1.2;
    color: var(--color-text-primary);
    letter-spacing: var(--tracking-tight);
    margin-bottom: var(--space-4);
  }

  h1 {
    font-size: var(--text-4xl);
    font-weight: var(--font-weight-extrabold);
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
  }

  h2 {
    font-size: var(--text-3xl);
  }

  h3 {
    font-size: var(--text-2xl);
  }

  h4 {
    font-size: var(--text-xl);
  }

  h5 {
    font-size: var(--text-lg);
  }

  h6 {
    font-size: var(--text-base);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wide);
    color: var(--color-text-tertiary);
  }

  p {
    margin-bottom: var(--space-4);
    color: var(--color-text-secondary);
  }

  strong {
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
  }

  em {
    font-style: italic;
    color: var(--color-text-tertiary);
  }

  small {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
  }

  /* ===== LISTES ===== */
  ul, ol {
    padding-left: var(--space-6);
    margin-bottom: var(--space-4);
  }

  li {
    margin-bottom: var(--space-2);
    color: var(--color-text-secondary);
  }

  /* ===== CITATIONS ET CODE ===== */
  blockquote {
    border-left: 3px solid var(--color-primary-300);
    padding-left: var(--space-4);
    margin: var(--space-6) 0;
    font-style: italic;
    color: var(--color-text-tertiary);
  }

  code {
    font-family: var(--font-family-mono);
    font-size: 0.9em;
    padding: var(--space-half) var(--space-1);
    background-color: var(--color-gray-100);
    border-radius: var(--radius-sm);
    color: var(--color-destructive-700);
  }

  pre {
    font-family: var(--font-family-mono);
    font-size: var(--text-sm);
    padding: var(--space-4);
    background-color: var(--color-gray-950);
    color: var(--color-gray-100);
    border-radius: var(--radius-lg);
    overflow-x: auto;
    margin: var(--space-6) 0;
  }

  pre code {
    background-color: transparent;
    padding: 0;
    color: inherit;
  }

  /* ===== TABLES ===== */
  table {
    width: 100%;
    border-collapse: collapse;
    margin: var(--space-6) 0;
    font-size: var(--text-sm);
  }

  thead {
    background-color: var(--color-gray-50);
    border-bottom: 2px solid var(--color-border);
  }

  th {
    padding: var(--space-3) var(--space-4);
    text-align: left;
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
  }

  td {
    padding: var(--space-3) var(--space-4);
    border-bottom: 1px solid var(--color-border);
    color: var(--color-text-secondary);
  }

  tbody tr:hover {
    background-color: var(--color-gray-50);
  }

  /* ===== SCROLLBAR AVANCÉE ===== */
  ::-webkit-scrollbar {
    width: 12px;
    height: 12px;
  }

  ::-webkit-scrollbar-track {
    background: var(--color-gray-100);
    border-radius: var(--radius-full);
  }

  ::-webkit-scrollbar-thumb {
    background: var(--color-gray-400);
    border-radius: var(--radius-full);
    border: 3px solid var(--color-gray-100);
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--color-gray-500);
  }

  ::-webkit-scrollbar-thumb:active {
    background: var(--color-primary-500);
  }

  ::-webkit-scrollbar-corner {
    background: var(--color-gray-100);
  }

  /* Firefox */
  * {
    scrollbar-width: thin;
    scrollbar-color: var(--color-gray-400) var(--color-gray-100);
  }

  /* ===== ANIMATIONS KEYFRAMES ===== */
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes slideUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes scaleIn {
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }

  @keyframes pulse {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }

  @keyframes shimmer {
    0% {
      background-position: -1000px 0;
    }
    100% {
      background-position: 1000px 0;
    }
  }

  /* ===== UTILITAIRES GLOBAUX ===== */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  .pointer-events-none {
    pointer-events: none;
  }

  .pointer-events-auto {
    pointer-events: auto;
  }

  .backdrop-blur {
    backdrop-filter: blur(var(--blur-backdrop));
    -webkit-backdrop-filter: blur(var(--blur-backdrop));
  }

  .glass {
    background: var(--gradient-glass);
    backdrop-filter: blur(var(--blur-backdrop));
    -webkit-backdrop-filter: blur(var(--blur-backdrop));
    border: 1px solid color-mix(in oklch, var(--color-white), transparent 20%);
  }

  .text-balance {
    text-wrap: balance;
  }

  .text-pretty {
    text-wrap: pretty;
  }

  /* ===== RESPONSIVE HELPERS ===== */
  .container {
    width: 100%;
    max-width: var(--container-max-width);
    margin: 0 auto;
    padding: 0 var(--gutter-base);
  }

  @media (min-width: 48rem) {
    .container {
      padding: 0 var(--gutter-lg);
    }
  }

  @media (min-width: 80rem) {
    .container {
      padding: 0 var(--gutter-xl);
    }
  }

  /* ===== LOADER MODERNE – CARTES SCOLAIRES ===== */

  .loader-overlay {
    position: fixed;
    inset: 0;
    z-index: 50;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(255, 255, 255, 0.75);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }

  .loader-page {
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .loader-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 14px;
  }

  /* --- Carte animée --- */
  .loader-card-wrapper {
    position: relative;
    width: 96px;
    height: 64px;
  }

  .loader-glow {
    position: absolute;
    inset: -20px;
    background: radial-gradient(circle, rgba(59, 130, 246, 0.35), transparent 60%);
    filter: blur(12px);
    animation: pulseGlow 2s ease-in-out infinite;
  }

  .loader-card {
    position: relative;
    width: 96px;
    height: 64px;
    border-radius: 14px;
    background: linear-gradient(135deg, #2563eb, #1e40af);
    box-shadow: 0 15px 30px rgba(0, 0, 0, 0.25);
    padding: 10px;
    display: flex;
    flex-direction: column;
    gap: 6px;
    animation: floatCard 2.2s ease-in-out infinite;
  }

  .loader-avatar {
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.9);
  }

  .loader-line {
    height: 6px;
    border-radius: 4px;
    background: rgba(255, 255, 255, 0.8);
  }

  .loader-line.short {
    width: 60%;
  }

  /* --- Badge sécurité --- */
  .loader-badge {
    position: absolute;
    bottom: -6px;
    right: -6px;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: #22c55e;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    animation: bounceBadge 1.4s infinite;
  }

  /* --- Texte --- */
  .loader-text {
    font-size: 14px;
    font-weight: 600;
    color: var(--color-foreground);
  }

  .loader-sub {
    font-size: 12px;
    color: #6b7280;
    margin: 0;
  }

  /* --- Points animés --- */
  .dots i {
    font-style: normal;
    animation: blink 1.4s infinite both;
  }

  .dots i:nth-child(2) {
    animation-delay: 0.2s;
  }

  .dots i:nth-child(3) {
    animation-delay: 0.4s;
  }

  /* ===== KEYFRAMES ANIMATIONS ===== */

  @keyframes floatCard {
    0% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-6px);
    }
    100% {
      transform: translateY(0);
    }
  }

  @keyframes pulseGlow {
    0%,
    100% {
      opacity: 0.6;
    }
    50% {
      opacity: 1;
    }
  }

  @keyframes bounceBadge {
    0%,
    100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-4px);
    }
  }

  @keyframes blink {
    0% {
      opacity: 0.2;
    }
    20% {
      opacity: 1;
    }
    100% {
      opacity: 0.2;
    }
  }

  /* ===== MEDIA QUERIES GLOBALES ===== */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }

  @media (prefers-contrast: high) {
    :root {
      --color-border: var(--color-gray-950);
      --color-primary-500: var(--color-gray-950);
    }
  }

  @media (prefers-color-scheme: dark) {
    :root:not(.light) {
      color-scheme: dark;
    }
  }

  /* Support de l'écriture RTL */
  [dir="rtl"] {
    text-align: right;
  }

  [dir="rtl"] ul,
  [dir="rtl"] ol {
    padding-left: 0;
    padding-right: var(--space-6);
  }

  [dir="rtl"] blockquote {
    border-left: none;
    border-right: 3px solid var(--color-primary-300);
    padding-left: 0;
    padding-right: var(--space-4);
  }
}